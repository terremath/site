<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carte d'Analyse ‚Äî R√©seau Interactif</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=JetBrains+Mono:wght@400;600&family=DM+Sans:wght@400;500;600;700&display=swap');

  :root {
    --bg: #0a0a0f;
    --bg2: #12121a;
    --surface: #1a1a28;
    --surface2: #222236;
    --border: #2a2a44;
    --text: #e8e6f0;
    --text-dim: #8888aa;
    --accent-blue: #4a7dff;
    --accent-cyan: #22d3ee;
    --accent-green: #34d399;
    --accent-amber: #fbbf24;
    --accent-red: #f87171;
    --accent-purple: #a78bfa;
    --accent-pink: #f472b6;
    --accent-orange: #fb923c;
    --glow-blue: rgba(74, 125, 255, 0.3);
    --glow-red: rgba(248, 113, 113, 0.25);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    overflow: hidden;
    height: 100vh;
    width: 100vw;
  }

  #app {
    display: flex;
    height: 100vh;
    width: 100vw;
  }

  /* ‚îÄ‚îÄ‚îÄ SVG Canvas ‚îÄ‚îÄ‚îÄ */
  #graph-container {
    flex: 1;
    position: relative;
    overflow: hidden;
  }

  svg {
    width: 100%;
    height: 100%;
    cursor: grab;
  }
  svg:active { cursor: grabbing; }

  /* ‚îÄ‚îÄ‚îÄ Links ‚îÄ‚îÄ‚îÄ */
  .link-true {
    stroke: var(--accent-green);
    stroke-opacity: 0.35;
    stroke-width: 1.8;
  }
  .link-false {
    stroke: var(--accent-red);
    stroke-opacity: 0.22;
    stroke-width: 1.4;
    stroke-dasharray: 6 4;
  }
  .link-conditional {
    stroke: var(--accent-amber);
    stroke-opacity: 0.32;
    stroke-width: 1.6;
    stroke-dasharray: 8 3 2 3;
  }
  .link-highlight {
    stroke-opacity: 1 !important;
    stroke-width: 3 !important;
  }
  .link-fade {
    stroke-opacity: 0.06 !important;
  }

  /* ‚îÄ‚îÄ‚îÄ Nodes ‚îÄ‚îÄ‚îÄ */
  .node-circle {
    cursor: pointer;
    transition: r 0.2s ease;
  }
  .node-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    fill: var(--text);
    pointer-events: none;
    text-anchor: middle;
    dominant-baseline: central;
    font-weight: 600;
  }
  .node-fade .node-circle { opacity: 0.15; }
  .node-fade .node-label { opacity: 0.15; }

  /* ‚îÄ‚îÄ‚îÄ Arrowheads ‚îÄ‚îÄ‚îÄ */
  marker path {
    stroke: none;
  }

  /* ‚îÄ‚îÄ‚îÄ Side Panel ‚îÄ‚îÄ‚îÄ */
  #panel {
    width: 420px;
    min-width: 420px;
    background: var(--bg2);
    border-left: 1px solid var(--border);
    overflow-y: auto;
    padding: 0;
    display: flex;
    flex-direction: column;
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  }
  #panel.collapsed {
    transform: translateX(420px);
    min-width: 0;
    width: 0;
    padding: 0;
    border: none;
  }

  #panel-header {
    padding: 28px 28px 20px;
    border-bottom: 1px solid var(--border);
    position: sticky;
    top: 0;
    background: var(--bg2);
    z-index: 2;
  }

  #panel-header h2 {
    font-family: 'EB Garamond', serif;
    font-size: 26px;
    font-weight: 700;
    margin-bottom: 4px;
    line-height: 1.2;
  }

  #panel-header .subtitle {
    font-size: 13px;
    color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
  }

  #panel-body {
    padding: 24px 28px 40px;
    flex: 1;
  }

  .section-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 10px;
    margin-top: 24px;
  }
  .section-title:first-child { margin-top: 0; }

  .def-block {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 12px;
    font-family: 'EB Garamond', serif;
    font-size: 16px;
    line-height: 1.55;
  }

  .impl-card {
    background: var(--surface);
    border-left: 3px solid var(--accent-green);
    border-radius: 0 8px 8px 0;
    padding: 14px 16px;
    margin-bottom: 10px;
    cursor: pointer;
    transition: background 0.15s;
  }
  .impl-card:hover { background: var(--surface2); }
  .impl-card.false-impl {
    border-left-color: var(--accent-red);
  }
  .impl-card.cond-impl {
    border-left-color: var(--accent-amber);
  }

  .impl-card .impl-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 6px;
  }
  .impl-card .impl-label .arrow-true { color: var(--accent-green); }
  .impl-card .impl-label .arrow-false { color: var(--accent-red); }
  .impl-card .impl-label .arrow-cond { color: var(--accent-amber); }

  .impl-card .impl-proof {
    font-family: 'EB Garamond', serif;
    font-size: 15px;
    line-height: 1.5;
    color: var(--text);
    display: none;
  }
  .impl-card.open .impl-proof { display: block; margin-top: 8px; }

  .counter-tag {
    display: inline-block;
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    background: rgba(248, 113, 113, 0.15);
    color: var(--accent-red);
    border: 1px solid rgba(248, 113, 113, 0.3);
    border-radius: 4px;
    padding: 2px 7px;
    margin-left: 6px;
    vertical-align: middle;
  }

  .proof-toggle {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    color: var(--accent-blue);
    cursor: pointer;
    margin-top: 4px;
    display: inline-block;
  }

  /* ‚îÄ‚îÄ‚îÄ Legend / Controls ‚îÄ‚îÄ‚îÄ */
  #controls {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 10;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .ctrl-box {
    background: rgba(18, 18, 26, 0.92);
    backdrop-filter: blur(12px);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 18px;
  }

  .ctrl-box h3 {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 10px;
  }

  .legend-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
    font-size: 12px;
  }
  .legend-line {
    width: 28px;
    height: 3px;
    border-radius: 2px;
  }
  .legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
  }

  .filter-btn {
    background: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.15s;
    margin-right: 4px;
    margin-bottom: 4px;
  }
  .filter-btn:hover { border-color: var(--accent-blue); color: var(--text); }
  .filter-btn.active { background: var(--accent-blue); color: #fff; border-color: var(--accent-blue); }

  /* ‚îÄ‚îÄ‚îÄ Title bar ‚îÄ‚îÄ‚îÄ */
  #title-bar {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    z-index: 10;
    pointer-events: none;
  }
  #title-bar h1 {
    font-family: 'EB Garamond', serif;
    font-size: 28px;
    font-weight: 700;
    letter-spacing: -0.5px;
    text-shadow: 0 0 40px rgba(74, 125, 255, 0.3);
  }
  #title-bar p {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--text-dim);
    margin-top: 4px;
  }

  /* ‚îÄ‚îÄ‚îÄ Tooltip ‚îÄ‚îÄ‚îÄ */
  #tooltip {
    position: absolute;
    pointer-events: none;
    background: rgba(18, 18, 26, 0.95);
    backdrop-filter: blur(8px);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 13px;
    max-width: 260px;
    z-index: 100;
    opacity: 0;
    transition: opacity 0.15s;
    font-family: 'DM Sans', sans-serif;
  }
  #tooltip.visible { opacity: 1; }

  /* ‚îÄ‚îÄ‚îÄ Scrollbar ‚îÄ‚îÄ‚îÄ */
  #panel::-webkit-scrollbar { width: 6px; }
  #panel::-webkit-scrollbar-track { background: transparent; }
  #panel::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  /* ‚îÄ‚îÄ‚îÄ Welcome state ‚îÄ‚îÄ‚îÄ */
  .welcome {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-dim);
  }
  .welcome .icon {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.4;
  }
  .welcome h3 {
    font-family: 'EB Garamond', serif;
    font-size: 20px;
    color: var(--text);
    margin-bottom: 8px;
  }
  .welcome p {
    font-size: 13px;
    line-height: 1.6;
  }

  .math {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9em;
    color: var(--accent-cyan);
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=EB+Garamond:ital,wght@0,500;1,500&display=swap" rel="stylesheet">
</head>
<body>
<style>
.tm-nav {
  --nav-h: 180px;
  position: relative;
  width: 100%;
  height: var(--nav-h);
  background: #0a0805;
  box-sizing: border-box;
  font-family: 'Cormorant Garamond', Georgia, serif;
  overflow: visible;
  z-index: 100;
}
.tm-nav::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg,
    transparent 0%, rgba(201,168,76,0.4) 20%,
    rgba(201,168,76,0.85) 50%, rgba(201,168,76,0.4) 80%, transparent 100%);
  z-index: 20; pointer-events: none;
}
.tm-inner {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
}
.tm-f {
  position: absolute;
  font-family: 'EB Garamond', Georgia, serif;
  font-style: italic;
  font-weight: 500;
  color: #c9a84c;
  white-space: nowrap;
  opacity: 0;
  text-shadow: 0 0 16px rgba(201,168,76,0.9), 0 0 32px rgba(201,168,76,0.35);
  animation: tm-formula-life 4.2s ease forwards;
}
.tm-f:nth-child(1)  { animation-delay: 0.00s; }
.tm-f:nth-child(2)  { animation-delay: 0.11s; }
.tm-f:nth-child(3)  { animation-delay: 0.22s; }
.tm-f:nth-child(4)  { animation-delay: 0.33s; }
.tm-f:nth-child(5)  { animation-delay: 0.44s; }
.tm-f:nth-child(6)  { animation-delay: 0.55s; }
.tm-f:nth-child(7)  { animation-delay: 0.66s; }
.tm-f:nth-child(8)  { animation-delay: 0.77s; }
.tm-f:nth-child(9)  { animation-delay: 0.88s; }
.tm-f:nth-child(10) { animation-delay: 0.99s; }
.tm-f:nth-child(11) { animation-delay: 1.10s; }
.tm-f:nth-child(12) { animation-delay: 1.21s; }
.tm-f:nth-child(13) { animation-delay: 1.32s; }
.tm-f:nth-child(14) { animation-delay: 1.43s; }
.tm-f:nth-child(15) { animation-delay: 1.54s; }
.tm-f:nth-child(16) { animation-delay: 1.65s; }
.tm-f:nth-child(17) { animation-delay: 1.76s; }
.tm-f:nth-child(18) { animation-delay: 1.87s; }
.tm-f:nth-child(19) { animation-delay: 1.98s; }
.tm-f:nth-child(20) { animation-delay: 2.09s; }
.tm-f:nth-child(21) { animation-delay: 2.20s; }
.tm-f:nth-child(22) { animation-delay: 2.31s; }
.tm-f:nth-child(23) { animation-delay: 2.42s; }
.tm-f:nth-child(24) { animation-delay: 2.53s; }
@keyframes tm-formula-life {
  0%   { opacity: 0; }
  8%   { opacity: 1; }
  75%  { opacity: 1; }
  100% { opacity: 0; }
}
.tm-center-logo {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) scale(1);
  z-index: 10;
  display: flex; flex-direction: column;
  align-items: center; gap: 6px;
  opacity: 0; pointer-events: none;
  animation: tm-center-appear 1.4s cubic-bezier(.4,0,.2,1) 4.3s forwards;
}
.tm-center-logo img {
  width: 80px; height: 80px;
  border-radius: 50%;
  border: 2px solid rgba(201,168,76,0.65);
  box-shadow: 0 0 28px rgba(201,168,76,0.4), 0 0 55px rgba(201,168,76,0.14);
  object-fit: cover; display: block;
}
.tm-center-logo .tm-ctitle {
  display: flex; flex-direction: column;
  align-items: center; line-height: 1.1;
}
.tm-center-logo .tm-ctitle span {
  font-family: 'Cormorant Garamond', serif;
  font-weight: 700; font-size: 1.45rem;
  color: #e2c06a; letter-spacing: 8px;
  text-transform: uppercase;
  text-shadow: 0 0 28px rgba(201,168,76,0.55), 0 2px 4px rgba(0,0,0,0.7);
}
@keyframes tm-center-appear {
  0%   { opacity: 0; transform: translate(-50%,-50%) scale(0.35); filter: blur(14px); }
  35%  { opacity: 1; filter: blur(0);  transform: translate(-50%,-50%) scale(1.05); }
  60%  { opacity: 1; transform: translate(-50%,-50%) scale(1); }
  85%  { opacity: 1; transform: translate(-50%,-50%) scale(1); }
  100% { opacity: 0; transform: translate(-130%,-50%) scale(0.65); }
}
.tm-left-logo {
  position: absolute;
  top: 50%; left: 16px;
  transform: translateY(-50%);
  z-index: 15;
  display: flex; align-items: center; gap: 10px;
  opacity: 0; text-decoration: none;
  animation: tm-fadein 0.7s ease 5.7s forwards;
  max-width: 220px;
}
.tm-left-logo img {
  width: 50px; height: 50px;
  border-radius: 50%;
  border: 2px solid rgba(201,168,76,0.55);
  box-shadow: 0 0 18px rgba(201,168,76,0.28);
  object-fit: cover; flex-shrink: 0;
}
.tm-left-logo .tm-ltitle {
  display: flex; flex-direction: column; line-height: 1.15;
}
.tm-left-logo .tm-ltitle span {
  font-family: 'Cormorant Garamond', serif;
  font-weight: 700; font-size: 0.85rem;
  color: #e2c06a; letter-spacing: 3px;
  text-transform: uppercase;
  text-shadow: 0 0 14px rgba(201,168,76,0.45), 0 1px 3px rgba(0,0,0,0.8);
}
@keyframes tm-fadein { from { opacity:0; } to { opacity:1; } }
.tm-menu {
  position: absolute;
  top: 50%; right: 16px;
  transform: translateY(-50%);
  z-index: 200;
  display: flex; align-items: center; gap: 0;
  opacity: 0;
  animation: tm-fadein 0.7s ease 6.2s forwards;
}
.tm-menu > a,
.tm-dd > a {
  font-family: 'Cormorant Garamond', serif;
  font-weight: 600; font-size: 0.78rem;
  color: rgba(201,168,76,0.88);
  text-decoration: none; letter-spacing: 2px;
  text-transform: uppercase;
  padding: 8px 8px;
  border: 1px solid transparent; border-radius: 2px;
  transition: color 0.25s, border-color 0.25s, text-shadow 0.25s;
  white-space: nowrap; display: inline-block;
}
.tm-menu > a:hover,
.tm-dd > a:hover {
  color: #e2c06a;
  border-color: rgba(201,168,76,0.32);
  text-shadow: 0 0 12px rgba(201,168,76,0.5);
}
.tm-dd { position: relative; }
.tm-dd-panel {
  display: none;
  position: absolute;
  top: 100%; left: 0;
  min-width: 220px;
  background: rgba(7,5,2,0.97);
  border: 1px solid rgba(201,168,76,0.2);
  border-top: 2px solid rgba(201,168,76,0.55);
  padding: 6px 0;
  z-index: 9999;
  box-shadow: 0 10px 36px rgba(0,0,0,0.7);
}
.tm-dd:hover .tm-dd-panel { display: block; }
.tm-dd-panel a {
  display: block;
  font-family: 'Cormorant Garamond', serif;
  font-weight: 600; font-size: 0.8rem;
  letter-spacing: 2px; text-transform: uppercase;
  text-decoration: none; padding: 10px 20px;
  color: rgba(201,168,76,0.7);
  transition: color 0.2s, background 0.2s;
}
.tm-dd-panel a:hover { color: #e2c06a; background: rgba(201,168,76,0.06); }
#tm-toggle { display: none; }
.tm-hamburger {
  display: none;
  position: absolute;
  top: 50%; right: 18px;
  transform: translateY(-50%);
  z-index: 300;
  cursor: pointer;
  padding: 8px;
  flex-direction: column; gap: 6px;
}
.tm-hamburger span {
  display: block;
  width: 26px; height: 2px;
  background: #e2c06a; border-radius: 2px;
  transition: transform 0.3s, opacity 0.3s;
  transform-origin: center;
}
.tm-nav.drawer-open .tm-hamburger span:nth-child(1) { transform: translateY(8px) rotate(45deg); }
.tm-nav.drawer-open .tm-hamburger span:nth-child(2) { opacity: 0; }
.tm-nav.drawer-open .tm-hamburger span:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
.tm-drawer {
  position: absolute;
  top: 100%; left: 0; right: 0;
  background: rgba(7,5,2,0.98);
  border-bottom: 1px solid rgba(201,168,76,0.2);
  z-index: 25; max-height: 0; overflow: hidden;
  transition: max-height 0.4s ease;
}
.tm-nav.drawer-open .tm-drawer { max-height: 600px; }
.tm-drawer-inner { padding: 10px 0 24px; }
.tm-drawer a {
  display: block;
  font-family: 'Cormorant Garamond', serif;
  font-weight: 600; font-size: 1.05rem;
  color: rgba(201,168,76,0.8); text-decoration: none;
  letter-spacing: 3px; text-transform: uppercase;
  padding: 13px 28px;
  border-bottom: 1px solid rgba(201,168,76,0.06);
  transition: color 0.2s, background 0.2s;
}
.tm-drawer a:hover { color: #e2c06a; background: rgba(201,168,76,0.05); }
.tm-drawer-section {
  font-family: 'EB Garamond', serif; font-style: italic;
  font-size: 0.72rem; color: rgba(201,168,76,0.38);
  letter-spacing: 3px; text-transform: uppercase;
  padding: 16px 28px 4px;
}
.tm-drawer .tm-sub {
  padding-left: 44px; font-size: 0.88rem;
  letter-spacing: 2px; color: rgba(201,168,76,0.62);
}
@media (max-width: 768px) {
  .tm-nav { --nav-h: 100px; }
  .tm-menu  { display: none !important; }
  .tm-hamburger { display: flex; }
  .tm-center-logo img { width: 52px !important; height: 52px !important; }
  .tm-center-logo .tm-ctitle span { font-size: 1rem !important; letter-spacing: 5px !important; }
  .tm-left-logo img { width: 46px; height: 46px; }
  .tm-left-logo .tm-ltitle { display: none; }
  .tm-f { font-size: 0.68rem !important; }
}
@media (min-width: 769px) and (max-width: 1100px) {
  .tm-left-logo .tm-ltitle { display: none; }
  .tm-menu > a,
  .tm-dd > a { font-size: 0.72rem; padding: 8px 6px; letter-spacing: 1.5px; }
}
@media (min-width: 769px) {
  .tm-hamburger { display: none !important; }
  .tm-drawer    { display: none !important; }
  #tm-toggle    { display: none !important; }
}

  /* ‚îÄ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ */
  footer {
    padding: 40px 40px 32px;
    border-top: 1px solid rgba(201,168,76,0.12);
  }

  .footer-inner {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 24px;
  }

  .footer-left {
    display: flex;
    align-items: center;
    gap: 14px;
    text-decoration: none;
  }

  .footer-left img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 1.5px solid rgba(201,168,76,0.4);
    object-fit: cover;
  }

  .footer-left .footer-brand {
    display: flex;
    flex-direction: column;
    line-height: 1.15;
  }

  .footer-left .footer-brand span {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 700;
    font-size: 0.85rem;
    color: rgba(201,168,76,0.7);
    letter-spacing: 4px;
    text-transform: uppercase;
  }

  .footer-copy {
    font-size: 0.72rem;
    color: var(--text-muted, #7A8BA3);
    margin-top: 8px;
    font-family: 'DM Sans', sans-serif;
    letter-spacing: 0;
    text-transform: none;
    font-weight: 400;
  }

  .footer-socials {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .footer-socials a {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 1px solid rgba(201,168,76,0.15);
    background: rgba(201,168,76,0.04);
    transition: all 0.3s ease;
  }

  .footer-socials a:hover {
    border-color: rgba(201,168,76,0.4);
    background: rgba(201,168,76,0.1);
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(201,168,76,0.15);
  }

  .footer-socials a svg {
    width: 18px;
    height: 18px;
    fill: rgba(201,168,76,0.65);
    transition: fill 0.3s ease;
  }

  .footer-socials a:hover svg {
    fill: #e2c06a;
  }
  /* ‚îÄ‚îÄ‚îÄ Footer Legal Links ‚îÄ‚îÄ‚îÄ */
  .footer-right {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 16px;
  }

  .footer-legal {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }

  .footer-legal a {
    color: rgba(201,168,76,0.5);
    text-decoration: none;
    font-size: 0.78rem;
    font-family: 'DM Sans', sans-serif;
    transition: color 0.3s ease;
    letter-spacing: 0.3px;
  }

  .footer-legal a:hover {
    color: #e2c06a;
  }

  @media (max-width: 600px) {
    .footer-right {
      align-items: center;
    }
    .footer-legal {
      justify-content: center;
      gap: 14px;
    }
  }


  @media (max-width: 600px) {
    .footer-inner {
      flex-direction: column;
      text-align: center;
      gap: 20px;
    }
    .footer-left {
      flex-direction: column;
      gap: 10px;
    }
    .footer-left .footer-brand {
      align-items: center;
    }
  }

</style>

<tm-header></tm-header>


<div id="app">
  <div id="graph-container">
    <svg id="svg"></svg>
    <div id="title-bar">
      <h1>Atlas d'Analyse R√©elle</h1>
      <p>Cliquez sur un n≈ìud pour explorer ‚Ä¢ Survolez un lien pour les d√©tails</p>
    </div>
    <div id="controls">
      <div class="ctrl-box">
        <h3>L√©gende</h3>
        <div class="legend-row">
          <div class="legend-line" style="background: var(--accent-green);"></div>
          <span>Implication vraie (‚áí)</span>
        </div>
        <div class="legend-row">
          <div class="legend-line" style="background: var(--accent-amber); background-image: repeating-linear-gradient(90deg, var(--accent-amber) 0 8px, transparent 8px 11px, var(--accent-amber) 11px 13px, transparent 13px 16px);"></div>
          <span>Conditionnelle (A + hyp ‚áí B)</span>
        </div>
        <div class="legend-row">
          <div class="legend-line" style="background: var(--accent-red); background-image: repeating-linear-gradient(90deg, var(--accent-red) 0 6px, transparent 6px 10px);"></div>
          <span>Fausse implication (‚áè)</span>
        </div>
        <div style="margin-top:10px;">
          <div class="legend-row"><div class="legend-dot" style="background: var(--accent-blue);"></div><span>R√©gularit√©</span></div>
          <div class="legend-row"><div class="legend-dot" style="background: var(--accent-amber);"></div><span>Ordre / Topologie</span></div>
          <div class="legend-row"><div class="legend-dot" style="background: var(--accent-purple);"></div><span>Mesure / Int√©gration</span></div>
          <div class="legend-row"><div class="legend-dot" style="background: var(--accent-pink);"></div><span>Zoo (contre-exemples)</span></div>
        </div>
      </div>
      <div class="ctrl-box">
        <h3>Filtres</h3>
        <div id="filter-buttons">
          <button class="filter-btn active" data-filter="all">Tout</button>
          <button class="filter-btn" data-filter="regularity">R√©gularit√©</button>
          <button class="filter-btn" data-filter="order">Ordre</button>
          <button class="filter-btn" data-filter="measure">Mesure</button>
          <button class="filter-btn" data-filter="zoo">Zoo</button>
        </div>
      </div>
    </div>
    <div id="tooltip"></div>
  </div>
  <div id="panel">
    <div id="panel-header">
      <h2 id="panel-title">Atlas d'Analyse</h2>
      <div class="subtitle" id="panel-subtitle">R√©seau interactif</div>
    </div>
    <div id="panel-body">
      <div class="welcome">
        <div class="icon">‚äõ</div>
        <h3>Explorez le r√©seau</h3>
        <p>Cliquez sur un n≈ìud (concept ou contre-exemple) pour afficher ses propri√©t√©s, implications et id√©es de preuves.</p>
        <p style="margin-top:12px;">Survolez un lien pour voir l'implication associ√©e.</p>
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>
<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA: Nodes
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const nodes = [
  // Regularity
  { id: "Lip", label: "Lip", group: "regularity", fullName: "Lipschitz", def: "‚àÉ K>0, |f(x)‚àíf(y)| ‚â§ K|x‚àíy| pour tout x, y.", radius: 22 },
  { id: "UC", label: "UC", group: "regularity", fullName: "Uniform√©ment continue", def: "‚àÄŒµ>0, ‚àÉŒ¥>0 tel que |x‚àíy|<Œ¥ ‚áí |f(x)‚àíf(y)|<Œµ, Œ¥ ind√©pendant du point.", radius: 22 },
  { id: "C0", label: "C‚Å∞", group: "regularity", fullName: "Continue", def: "Pour tout a, lim_{x‚Üía} f(x) = f(a).", radius: 26 },
  { id: "Diff", label: "Diff", group: "regularity", fullName: "D√©rivable", def: "La limite lim_{h‚Üí0} [f(x+h)‚àíf(x)]/h existe pour tout x de I.", radius: 24 },
  { id: "C1", label: "C¬π", group: "regularity", fullName: "D√©riv√©e continue", def: "f est d√©rivable et f‚Ä≤ est continue.", radius: 22 },
  { id: "AC", label: "AC", group: "regularity", fullName: "Absolument continue", def: "‚àÄŒµ>0, ‚àÉŒ¥>0 : pour toute collection finie d'intervalles disjoints (a‚Çñ,b‚Çñ) avec Œ£(b‚Çñ‚àía‚Çñ)<Œ¥, on a Œ£|f(b‚Çñ)‚àíf(a‚Çñ)|<Œµ.", radius: 20 },
  { id: "BV", label: "BV", group: "regularity", fullName: "Variation born√©e", def: "sup sur toutes les subdivisions de Œ£|f(x‚Çñ‚Çä‚ÇÅ)‚àíf(x‚Çñ)| < ‚àû.", radius: 20 },
  { id: "Diffpp", label: "Diff p.p.", group: "regularity", fullName: "D√©rivable presque partout", def: "f est d√©rivable sauf sur un ensemble de mesure nulle.", radius: 18 },
  { id: "IVP", label: "IVP", group: "order", fullName: "Valeurs interm√©diaires (Darboux)", def: "Si f(a)<v<f(b), il existe c‚àà(a,b) tel que f(c)=v. Toute d√©riv√©e poss√®de cette propri√©t√©.", radius: 20 },

  // Order / topology
  { id: "Mono", label: "Mono", group: "order", fullName: "Monotone", def: "f est croissante (ou d√©croissante) sur tout I.", radius: 20 },
  { id: "SM", label: "SM", group: "order", fullName: "Strictement monotone", def: "x < y ‚áí f(x) < f(y) (ou > strict).", radius: 20 },
  { id: "Inj", label: "Inj", group: "order", fullName: "Injective", def: "f(x)=f(y) ‚áí x=y.", radius: 20 },
  { id: "Surj", label: "Surj", group: "order", fullName: "Surjective", def: "Pour tout y dans l'ensemble d'arriv√©e, ‚àÉx tel que f(x)=y.", radius: 18 },
  { id: "Bij", label: "Bij", group: "order", fullName: "Bijective", def: "Injective et surjective.", radius: 18 },
  { id: "Homeo", label: "Hom√©o", group: "order", fullName: "Hom√©omorphisme", def: "Bijection continue dont l'inverse est aussi continue.", radius: 20 },
  { id: "Diffeo", label: "Diff√©o", group: "order", fullName: "Diff√©omorphisme", def: "Bijection C¬π dont l'inverse est aussi C¬π (f‚Ä≤‚â†0 partout).", radius: 20 },

  // Higher regularity
  { id: "Cinf", label: "C‚àû", group: "regularity", fullName: "Infiniment d√©rivable", def: "f admet des d√©riv√©es de tout ordre, toutes continues. Inclut les polyn√¥mes, exp, sin, cos, etc.", radius: 20 },

  // Measure / integration
  { id: "Rint", label: "R-int", group: "measure", fullName: "Riemann-int√©grable", def: "Sur [a,b] : f born√©e et l'ensemble des discontinuit√©s est de mesure nulle (crit√®re de Lebesgue).", radius: 22 },
  { id: "Baire1", label: "Baire 1", group: "measure", fullName: "Fonction de Baire classe 1", def: "Limite ponctuelle de fonctions continues. Toute d√©riv√©e est Baire 1.", radius: 16 },
  { id: "Bornee", label: "Born√©e", group: "measure", fullName: "Born√©e", def: "‚àÉM>0, |f(x)| ‚â§ M pour tout x dans le domaine. Condition n√©cessaire pour la R-int√©grabilit√© sur [a,b].", radius: 18 },

  // Zoo (counter-examples)
  { id: "Z1", label: "Z1", group: "zoo", fullName: "Z1 ¬∑ Weierstrass", def: "W(x) = Œ£ a‚Åøcos(b‚ÅøœÄx), 0<a<1, b impair, ab>1+3œÄ/2. Continue partout, d√©rivable nulle part.", radius: 18 },
  { id: "Z2", label: "Z2", group: "zoo", fullName: "Z2 ¬∑ Dirichlet", def: "ùüô_‚Ñö(x) : vaut 1 si x‚àà‚Ñö, 0 sinon. Discontinue partout.", radius: 16 },
  { id: "Z3", label: "Z3", group: "zoo", fullName: "Z3 ¬∑ Thomae (popcorn)", def: "t(p/q)=1/q (irr√©ductible), t(irrationnel)=0. Continue sur ‚Ñù\\‚Ñö, discontinue sur ‚Ñö.", radius: 18 },
  { id: "Z4", label: "Z4", group: "zoo", fullName: "Z4 ¬∑ Cantor (devil's staircase)", def: "Fonction croissante, continue, f‚Ä≤=0 p.p., mais f(0)=0 et f(1)=1 : non constante. Pas absolument continue.", radius: 20 },
  { id: "Z5", label: "Z5", group: "zoo", fullName: "Z5 ¬∑ Volterra", def: "D√©rivable partout, mais f‚Ä≤ est born√©e et non Riemann-int√©grable (discontinuit√©s de f‚Ä≤ sur un ensemble de mesure positive).", radius: 18 },
  { id: "Z6", label: "Z6", group: "zoo", fullName: "Z6 ¬∑ x¬≥", def: "f(x)=x¬≥ : C‚àû, bijective, mais f‚Åª¬π(y)=y^{1/3} n'est pas C¬π en 0 car (f‚Åª¬π)‚Ä≤(0)=+‚àû.", radius: 18 },
  { id: "Z7", label: "Z7", group: "zoo", fullName: "Z7 ¬∑ x + sin(x¬≤)", def: "f(x)=x+sin(x¬≤) : C‚àû, surjective ‚Ñù‚Üí‚Ñù (car ‚Üí¬±‚àû), mais pas monotone (f‚Ä≤ change de signe infiniment).", radius: 18 },
  { id: "Z8", label: "Z8", group: "zoo", fullName: "Z8 ¬∑ x¬≤", def: "f(x)=x¬≤ sur ‚Ñù : continue mais pas uniform√©ment continue (|f(x)‚àíf(y)| peut √™tre grand pour |x‚àíy| petit si x est grand).", radius: 16 },
  { id: "Z9", label: "Z9", group: "zoo", fullName: "Z9 ¬∑ sin(1/x)", def: "f(x)=sin(1/x) pour x‚â†0, f(0)=0 : poss√®de la propri√©t√© des valeurs interm√©diaires mais n'est pas continue en 0.", radius: 18 },
  { id: "Z10", label: "Z10", group: "zoo", fullName: "Z10 ¬∑ Permutation d'intervalles", def: "Bijection ‚Ñù‚Üí‚Ñù obtenue par permutation non monotone de [n,n+1) : injective mais pas monotone.", radius: 16 },
  { id: "Z11", label: "Z11", group: "zoo", fullName: "Z11 ¬∑ Cauchy additive", def: "f(x+y)=f(x)+f(y) non continue : graphe dense dans ‚Ñù¬≤, non mesurable. Existe par axiome du choix.", radius: 16 },
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA: Links
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const links = [
  // === TRUE IMPLICATIONS ===
  // Regularity ladder
  { source: "Lip", target: "UC", type: "true", label: "Lip ‚áí UC",
    proof: "Si |f(x)‚àíf(y)| ‚â§ K|x‚àíy|, alors pour Œµ>0 on pose Œ¥=Œµ/K. Ce Œ¥ convient uniform√©ment (ne d√©pend pas du point)." },
  { source: "Lip", target: "AC", type: "true", label: "Lip ‚áí AC",
    proof: "Pour des intervalles disjoints (a‚Çñ,b‚Çñ) : Œ£|f(b‚Çñ)‚àíf(a‚Çñ)| ‚â§ KŒ£(b‚Çñ‚àía‚Çñ). On choisit Œ¥=Œµ/K." },
  { source: "UC", target: "C0", type: "true", label: "UC ‚áí C‚Å∞",
    proof: "Uniform√©ment continue ‚áí continue en chaque point (le Œ¥ uniforme marche a fortiori point par point)." },
  { source: "AC", target: "BV", type: "true", label: "AC ‚áí BV",
    proof: "On d√©coupe [a,b] en sous-intervalles de longueur < Œ¥. Sur chacun la variation est < Œµ. Total fini." },
  { source: "BV", target: "Diffpp", type: "true", label: "BV ‚áí Diff p.p.",
    proof: "Th√©or√®me de Lebesgue : toute fonction BV = diff√©rence de deux croissantes. Chaque croissante est d√©rivable p.p. (argument de comptage des rapports de Dini)." },
  { source: "Mono", target: "BV", type: "true", label: "Mono ‚áí BV",
    proof: "Si f est croissante sur [a,b], toute somme t√©lescopique donne Œ£|f(x‚Çñ‚Çä‚ÇÅ)‚àíf(x‚Çñ)| = f(b)‚àíf(a) <‚àû." },
  { source: "Diff", target: "C0", type: "true", label: "Diff ‚áí C‚Å∞",
    proof: "f(x+h)‚àíf(x) = h¬∑[f(x+h)‚àíf(x)]/h ‚Üí 0¬∑f‚Ä≤(x) = 0 quand h‚Üí0. Donc f est continue." },
  { source: "C1", target: "Diff", type: "true", label: "C¬π ‚áí Diff",
    proof: "Par d√©finition, C¬π signifie que f‚Ä≤ existe et est continue. Donc f est d√©rivable." },
  { source: "Cinf", target: "C1", type: "true", label: "C‚àû ‚áí C¬π",
    proof: "C‚àû signifie que toutes les d√©riv√©es existent et sont continues. En particulier f‚Ä≤ existe et est continue, donc f ‚àà C¬π." },
  { source: "Diff", target: "IVP", type: "true", label: "f d√©rivable ‚áí f‚Ä≤ a Darboux",
    proof: "Th√©or√®me de Darboux : si f‚Ä≤(a)<v<f‚Ä≤(b), on pose g(x)=f(x)‚àívx. Alors g‚Ä≤(a)<0 et g‚Ä≤(b)>0, g atteint son min en c‚àà(a,b), donc g‚Ä≤(c)=0 i.e. f‚Ä≤(c)=v." },
  { source: "Diff", target: "Baire1", type: "true", label: "f‚Ä≤ est Baire 1",
    proof: "f‚Ä≤(x) = lim_n n[f(x+1/n)‚àíf(x)]. Chaque f‚Çô(x) = n[f(x+1/n)‚àíf(x)] est continue (car f l'est), donc f‚Ä≤ est limite ponctuelle de continues = Baire 1." },

  // Order / topology
  { source: "SM", target: "Inj", type: "true", label: "SM ‚áí Inj",
    proof: "Si x‚â†y, disons x<y, alors f(x)<f(y) (ou >), donc f(x)‚â†f(y)." },
  { source: "C0", target: "SM", type: "conditional", label: "C‚Å∞ + Inj ‚áí SM (intervalle)",
    proof: "Sur un intervalle, f continue injective. Si f n'est pas monotone, ‚àÉ a<b<c avec f(b) pas entre f(a) et f(c). Le TVI donne un point o√π f reprend une valeur, contradiction avec l'injectivit√©." },
  { source: "SM", target: "Homeo", type: "conditional", label: "C‚Å∞ + SM ‚áí Hom√©o (I‚Üíf(I))",
    proof: "f continue strictement monotone sur I a une image qui est un intervalle (TVI). L'inverse est monotone de m√™me sens, donc continue (car monotone sur un intervalle avec image intervalle ‚áí continue)." },
  { source: "C1", target: "Diffeo", type: "conditional", label: "C¬π + f‚Ä≤‚â†0 ‚áí Diff√©o local",
    proof: "Par le th√©or√®me d'inversion locale. Si f‚Ä≤‚â†0 partout sur I, f est SM (car f‚Ä≤ de signe constant par Darboux), bijective sur f(I), et (f‚Åª¬π)‚Ä≤ = 1/f‚Ä≤ est continue." },
  { source: "Mono", target: "Rint", type: "true", label: "Mono ‚áí R-int",
    proof: "f monotone sur [a,b] : ses discontinuit√©s sont au plus d√©nombrables (associer √† chaque saut un rationnel dans l'ouvert du saut). D√©nombrable = mesure nulle, donc R-int√©grable par crit√®re de Lebesgue." },
  { source: "C0", target: "Rint", type: "true", label: "C‚Å∞ ‚áí R-int (sur [a,b])",
    proof: "f continue sur [a,b] compact ‚áí uniform√©ment continue. Pour Œµ>0, on prend une subdivision assez fine : sur chaque morceau, sup‚àíinf < Œµ. Donc sommes de Darboux sup ‚àí inf < Œµ(b‚àía)." },

  // Derivative => monotonicity
  { source: "Diff", target: "Mono", type: "conditional", label: "f‚Ä≤‚â•0 partout ‚áí f croissante",
    proof: "Par le th√©or√®me des accroissements finis : f(b)‚àíf(a) = f‚Ä≤(c)(b‚àía) ‚â• 0 pour a<b." },

  // IVP + Inj => SM (remarkable: no continuity needed!)
  { source: "IVP", target: "SM", type: "conditional", label: "IVP + Inj ‚áí SM",
    proof: "Si f a la propri√©t√© des valeurs interm√©diaires et est injective, supposons f non monotone. Alors ‚àÉ a<b<c avec (par ex.) f(a)<f(b) et f(b)>f(c). Par IVP entre a et b, puis entre b et c, on trouve deux ant√©c√©dents distincts d'une m√™me valeur : contradiction avec l'injectivit√©." },

  // C0 + Bij(‚Ñù‚Üí‚Ñù) => SM
  { source: "Bij", target: "SM", type: "conditional", label: "C‚Å∞ + Bij(‚Ñù‚Üí‚Ñù) ‚áí SM",
    proof: "Sur ‚Ñù, une bijection continue est en particulier injective et continue. Comme ‚Ñù est un intervalle, C‚Å∞+Inj ‚áí SM s'applique directement." },

  // AC correctifs (conditional implications)
  { source: "AC", target: "Mono", type: "conditional", label: "AC + f‚Ä≤‚â•0 p.p. ‚áí croissante",
    proof: "f absolument continue ‚áí f(b)‚àíf(a) = ‚à´‚Çê·µá f‚Ä≤(t)dt (th√©or√®me fondamental pour AC). Si f‚Ä≤‚â•0 p.p., l'int√©grale est ‚â•0, donc f(b)‚â•f(a)." },
  { source: "AC", target: "Diffpp", type: "conditional", label: "AC + f‚Ä≤=0 p.p. ‚áí constante",
    proof: "Par le m√™me th√©or√®me fondamental : f(b)‚àíf(a) = ‚à´‚Çê·µá f‚Ä≤(t)dt = ‚à´‚Çê·µá 0 dt = 0. Donc f est constante. C'est le 'correctif' qui manque √† l'escalier du diable (Z4 n'est pas AC)." },

  // C1 rigidity
  { source: "C1", target: "Mono", type: "conditional", label: "C¬π + f‚Ä≤=0 sur dense ‚áí f cste",
    proof: "Si f‚ààC¬π et f‚Ä≤=0 sur un ensemble dense D, alors par continuit√© de f‚Ä≤ : pour tout x, il existe une suite (d‚Çô)‚äÇD avec d‚Çô‚Üíx, et f‚Ä≤(d‚Çô)=0‚Üíf‚Ä≤(x). Donc f‚Ä≤‚â°0, et f est constante." },

  // Born√©e + disc. mesure nulle
  { source: "Bornee", target: "Rint", type: "true", label: "Born√©e + disc. mes. 0 ‚áí R-int",
    proof: "C'est exactement le crit√®re de Lebesgue-Riemann : f est R-int√©grable sur [a,b] si et seulement si f est born√©e et son ensemble de discontinuit√©s est de mesure de Lebesgue nulle." },

  // === FALSE IMPLICATIONS (counter-examples) ===
  { source: "C0", target: "Diff", type: "false", label: "C‚Å∞ ‚áè Diff", counter: "Z1",
    proof: "Weierstrass : la s√©rie Œ£a‚Åøcos(b‚ÅøœÄx) converge uniform√©ment (M-test) donc est continue. Mais les diff√©rences divis√©es divergent partout (le terme b‚Åø domine a‚Åø car ab>1)." },
  { source: "IVP", target: "C0", type: "false", label: "IVP ‚áè C‚Å∞", counter: "Z9",
    proof: "sin(1/x) oscille entre ‚àí1 et 1 infiniment pr√®s de 0 : elle prend toutes les valeurs interm√©diaires, mais n'a pas de limite en 0." },
  { source: "Inj", target: "Mono", type: "false", label: "Inj ‚áè Mono (sans C‚Å∞)", counter: "Z10",
    proof: "On permute les intervalles [n,n+1) par une permutation œÉ non monotone de ‚Ñ§. Sur chaque morceau f est affine (donc injective), mais globalement non monotone." },
  { source: "C1", target: "Diffeo", type: "false", label: "C¬π+Bij ‚áè Diff√©o", counter: "Z6",
    proof: "f(x)=x¬≥ : f‚Ä≤(0)=0. L'inverse y^{1/3} a une d√©riv√©e (1/3)y^{-2/3} ‚Üí ‚àû en 0. Le probl√®me : f‚Ä≤ s'annule, donc 1/f‚Ä≤ explose." },
  { source: "Surj", target: "SM", type: "false", label: "Surj C‚àû ‚áè SM", counter: "Z7",
    proof: "f(x)=x+sin(x¬≤) : f‚Ä≤(x)=1+2x¬∑cos(x¬≤). Pour x grand, 2x¬∑cos(x¬≤) oscille avec amplitude ‚Üí‚àû, donc f‚Ä≤ change de signe infiniment souvent." },
  { source: "Diffpp", target: "Mono", type: "false", label: "f‚Ä≤=0 p.p. ‚áè constante", counter: "Z4",
    proof: "Cantor-Lebesgue : f est construite sur l'ensemble triadique C (mesure 0). f est constante sur chaque intervalle du compl√©mentaire de C (donc f‚Ä≤=0 l√†). Mais f monte de 0 √† 1 'sur' C. Non AC car C a mesure 0 mais f y varie de 1." },
  { source: "C0", target: "UC", type: "false", label: "C‚Å∞(‚Ñù) ‚áè UC", counter: "Z8",
    proof: "f(x)=x¬≤ : |f(x)‚àíf(y)| = |x+y|¬∑|x‚àíy|. Pour x=n, y=n+1/n : |x‚àíy|=1/n‚Üí0 mais |f(x)‚àíf(y)|=|2n+1/n|/n ‚âà 2 ‚Üí pas de Œ¥ uniforme." },
  { source: "Diff", target: "Rint", type: "false", label: "Diff ‚áè f‚Ä≤ R-int", counter: "Z5",
    proof: "Volterra : on construit f d√©rivable partout avec f‚Ä≤ discontinue sur un Cantor 'gras' (mesure >0). Le crit√®re de Lebesgue pour f‚Ä≤ √©choue : l'ensemble des discontinuit√©s n'est pas de mesure nulle." },
  { source: "Rint", target: "C0", type: "false", label: "R-int ‚áè 'peu de discontinuit√©s'", counter: "Z3",
    proof: "Thomae : discontinue en tout rationnel (car t(p/q)=1/q>0 et des irrationnels proches donnent t=0). Mais continue en tout irrationnel (1/q‚Üí0 quand le d√©nominateur cro√Æt). ‚Ñö est de mesure 0, donc R-int√©grable." },

  // Zoo connections (which myths they bust)
  { source: "Z2", target: "Rint", type: "false", label: "born√©e+mesurable ‚áè R-int", counter: "Z2",
    proof: "ùüô_‚Ñö est born√©e, mesurable Lebesgue, mais les sommes de Darboux sup sont toutes 1 et les inf sont toutes 0 sur tout intervalle. Pas R-int√©grable." },
  { source: "Z11", target: "Lip", type: "false", label: "additive ‚áè lin√©aire", counter: "Z11",
    proof: "Par l'axiome du choix, on construit une base de Hamel de ‚Ñù sur ‚Ñö, et on d√©finit f de fa√ßon ‚Ñö-lin√©aire avec des valeurs 'folles'. Le r√©sultat est non mesurable, √† graphe dense dans ‚Ñù¬≤. Mais additive + mesurable ‚áí f(x)=ax." },
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BUILD GRAPH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const width = window.innerWidth - 420;
const height = window.innerHeight;

const svg = d3.select("#svg");
const tooltip = d3.select("#tooltip");

// Defs: arrowheads
const defs = svg.append("defs");
defs.append("marker").attr("id", "arrow-true").attr("viewBox", "0 0 10 6").attr("refX", 10).attr("refY", 3)
  .attr("markerWidth", 8).attr("markerHeight", 6).attr("orient", "auto")
  .append("path").attr("d", "M0,0 L10,3 L0,6 Z").attr("fill", "#34d399");
defs.append("marker").attr("id", "arrow-false").attr("viewBox", "0 0 10 6").attr("refX", 10).attr("refY", 3)
  .attr("markerWidth", 8).attr("markerHeight", 6).attr("orient", "auto")
  .append("path").attr("d", "M0,0 L10,3 L0,6 Z").attr("fill", "#f87171");
defs.append("marker").attr("id", "arrow-conditional").attr("viewBox", "0 0 10 6").attr("refX", 10).attr("refY", 3)
  .attr("markerWidth", 8).attr("markerHeight", 6).attr("orient", "auto")
  .append("path").attr("d", "M0,0 L10,3 L0,6 Z").attr("fill", "#fbbf24");

// Radial gradient for node glow
const groupColors = {
  regularity: { main: "#4a7dff", glow: "rgba(74,125,255,0.4)" },
  order:      { main: "#fbbf24", glow: "rgba(251,191,36,0.4)" },
  measure:    { main: "#a78bfa", glow: "rgba(167,139,250,0.4)" },
  zoo:        { main: "#f472b6", glow: "rgba(244,114,182,0.4)" },
};

nodes.forEach(n => {
  const c = groupColors[n.group];
  const grad = defs.append("radialGradient").attr("id", `grad-${n.id}`);
  grad.append("stop").attr("offset", "0%").attr("stop-color", c.main).attr("stop-opacity", 0.9);
  grad.append("stop").attr("offset", "70%").attr("stop-color", c.main).attr("stop-opacity", 0.6);
  grad.append("stop").attr("offset", "100%").attr("stop-color", c.main).attr("stop-opacity", 0.2);
});

// Container for zoom
const g = svg.append("g");

// Zoom behavior
const zoom = d3.zoom()
  .scaleExtent([0.3, 4])
  .on("zoom", (event) => g.attr("transform", event.transform));
svg.call(zoom);

// Draw links
const linkG = g.append("g").attr("class", "links");
const linkElements = linkG.selectAll("line")
  .data(links).enter().append("line")
  .attr("class", d => d.type === "true" ? "link-true" : d.type === "conditional" ? "link-conditional" : "link-false")
  .attr("marker-end", d => d.type === "true" ? "url(#arrow-true)" : d.type === "conditional" ? "url(#arrow-conditional)" : "url(#arrow-false)")
  .on("mouseenter", function(event, d) {
    d3.select(this).classed("link-highlight", true);
    const sym = d.type === "true" ? "‚áí" : "‚áè";
    let html = `<strong>${d.label}</strong>`;
    if (d.counter) html += ` <span style="color:var(--accent-red)">[${d.counter}]</span>`;
    html += `<br><span style="color:var(--text-dim);font-size:11px;">Cliquez sur un n≈ìud pour les d√©tails</span>`;
    tooltip.html(html).classed("visible", true);
  })
  .on("mousemove", function(event) {
    tooltip.style("left", (event.pageX + 14) + "px").style("top", (event.pageY - 14) + "px");
  })
  .on("mouseleave", function() {
    d3.select(this).classed("link-highlight", false);
    tooltip.classed("visible", false);
  });

// Draw nodes
const nodeG = g.append("g").attr("class", "nodes");
const nodeGroups = nodeG.selectAll("g")
  .data(nodes).enter().append("g")
  .attr("class", "node-group")
  .call(d3.drag()
    .on("start", dragStart)
    .on("drag", dragged)
    .on("end", dragEnd));

nodeGroups.append("circle")
  .attr("class", "node-circle")
  .attr("r", d => d.radius)
  .attr("fill", d => `url(#grad-${d.id})`)
  .attr("stroke", d => groupColors[d.group].main)
  .attr("stroke-width", 1.5)
  .attr("stroke-opacity", 0.6);

nodeGroups.append("text")
  .attr("class", "node-label")
  .text(d => d.label);

// Click handler
nodeGroups.on("click", (event, d) => {
  event.stopPropagation();
  selectNode(d);
});

svg.on("click", () => clearSelection());

// Force simulation
const simulation = d3.forceSimulation(nodes)
  .force("link", d3.forceLink(links).id(d => d.id).distance(d => {
    // Zoo links shorter to cluster
    if (d.source.group === "zoo" || d.target.group === "zoo") return 120;
    return 160;
  }).strength(0.4))
  .force("charge", d3.forceManyBody().strength(-420))
  .force("center", d3.forceCenter(width / 2, height / 2))
  .force("collision", d3.forceCollide().radius(d => d.radius + 12))
  .force("x", d3.forceX(width / 2).strength(0.04))
  .force("y", d3.forceY(height / 2).strength(0.04))
  .on("tick", ticked);

function ticked() {
  linkElements
    .attr("x1", d => d.source.x).attr("y1", d => d.source.y)
    .attr("x2", d => {
      const dx = d.target.x - d.source.x;
      const dy = d.target.y - d.source.y;
      const dist = Math.sqrt(dx*dx + dy*dy) || 1;
      return d.target.x - (dx / dist) * (d.target.radius || 20);
    })
    .attr("y2", d => {
      const dx = d.target.x - d.source.x;
      const dy = d.target.y - d.source.y;
      const dist = Math.sqrt(dx*dx + dy*dy) || 1;
      return d.target.y - (dy / dist) * (d.target.radius || 20);
    });

  nodeGroups.attr("transform", d => `translate(${d.x},${d.y})`);
}

// Drag functions
function dragStart(event, d) {
  if (!event.active) simulation.alphaTarget(0.3).restart();
  d.fx = d.x; d.fy = d.y;
}
function dragged(event, d) {
  d.fx = event.x; d.fy = event.y;
}
function dragEnd(event, d) {
  if (!event.active) simulation.alphaTarget(0);
  d.fx = null; d.fy = null;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SELECTION & PANEL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let selectedNode = null;

function selectNode(d) {
  selectedNode = d;

  // Highlight connected
  const connectedIds = new Set([d.id]);
  links.forEach(l => {
    const sid = typeof l.source === "object" ? l.source.id : l.source;
    const tid = typeof l.target === "object" ? l.target.id : l.target;
    if (sid === d.id) connectedIds.add(tid);
    if (tid === d.id) connectedIds.add(sid);
  });

  nodeGroups.classed("node-fade", n => !connectedIds.has(n.id));
  nodeGroups.select(".node-circle").attr("stroke-width", n => n.id === d.id ? 3.5 : 1.5);

  linkElements
    .classed("link-highlight", l => {
      const sid = typeof l.source === "object" ? l.source.id : l.source;
      const tid = typeof l.target === "object" ? l.target.id : l.target;
      return sid === d.id || tid === d.id;
    })
    .classed("link-fade", l => {
      const sid = typeof l.source === "object" ? l.source.id : l.source;
      const tid = typeof l.target === "object" ? l.target.id : l.target;
      return sid !== d.id && tid !== d.id;
    });

  updatePanel(d);
}

function clearSelection() {
  selectedNode = null;
  nodeGroups.classed("node-fade", false);
  nodeGroups.select(".node-circle").attr("stroke-width", 1.5);
  linkElements.classed("link-highlight", false).classed("link-fade", false);

  document.getElementById("panel-title").textContent = "Atlas d'Analyse";
  document.getElementById("panel-subtitle").textContent = "R√©seau interactif";
  document.getElementById("panel-body").innerHTML = `
    <div class="welcome">
      <div class="icon">‚äõ</div>
      <h3>Explorez le r√©seau</h3>
      <p>Cliquez sur un n≈ìud (concept ou contre-exemple) pour afficher ses propri√©t√©s, implications et id√©es de preuves.</p>
      <p style="margin-top:12px;">Survolez un lien pour voir l'implication associ√©e.</p>
    </div>`;
}

function updatePanel(d) {
  document.getElementById("panel-title").textContent = d.fullName;
  document.getElementById("panel-subtitle").textContent = d.group === "zoo" ? "Contre-exemple" : d.group.charAt(0).toUpperCase() + d.group.slice(1);

  let html = '';

  // Definition
  html += `<div class="section-title">D√©finition</div>`;
  html += `<div class="def-block">${d.def}</div>`;

  // Outgoing true implications
  const outTrue = links.filter(l => {
    const sid = typeof l.source === "object" ? l.source.id : l.source;
    return sid === d.id && l.type === "true";
  });
  // Incoming true implications
  const inTrue = links.filter(l => {
    const tid = typeof l.target === "object" ? l.target.id : l.target;
    return tid === d.id && l.type === "true";
  });
  // Outgoing conditional
  const outCond = links.filter(l => {
    const sid = typeof l.source === "object" ? l.source.id : l.source;
    return sid === d.id && l.type === "conditional";
  });
  // Incoming conditional
  const inCond = links.filter(l => {
    const tid = typeof l.target === "object" ? l.target.id : l.target;
    return tid === d.id && l.type === "conditional";
  });
  // Outgoing false
  const outFalse = links.filter(l => {
    const sid = typeof l.source === "object" ? l.source.id : l.source;
    return sid === d.id && l.type === "false";
  });
  // Incoming false
  const inFalse = links.filter(l => {
    const tid = typeof l.target === "object" ? l.target.id : l.target;
    return tid === d.id && l.type === "false";
  });

  if (outTrue.length > 0) {
    html += `<div class="section-title">Implique (‚áí)</div>`;
    outTrue.forEach(l => {
      html += makeCard(l, "true");
    });
  }

  if (inTrue.length > 0) {
    html += `<div class="section-title">Impliqu√© par (‚áê)</div>`;
    inTrue.forEach(l => {
      html += makeCard(l, "true", true);
    });
  }

  if (outCond.length > 0 || inCond.length > 0) {
    html += `<div class="section-title">Conditionnelles (+ hypoth√®se ‚áí)</div>`;
    outCond.forEach(l => html += makeCard(l, "conditional"));
    inCond.forEach(l => html += makeCard(l, "conditional", true));
  }

  if (outFalse.length > 0 || inFalse.length > 0) {
    html += `<div class="section-title">Fausses implications (‚áè)</div>`;
    outFalse.forEach(l => html += makeCard(l, "false"));
    inFalse.forEach(l => html += makeCard(l, "false", true));
  }

  document.getElementById("panel-body").innerHTML = html;

  // Toggle proof visibility
  document.querySelectorAll(".impl-card").forEach(card => {
    card.addEventListener("click", () => card.classList.toggle("open"));
  });
}

function makeCard(link, type, isReverse = false) {
  const arrowClass = type === "false" ? "arrow-false" : type === "conditional" ? "arrow-cond" : "arrow-true";
  const cardClass = type === "false" ? " false-impl" : type === "conditional" ? " cond-impl" : "";
  const counterHtml = link.counter ? `<span class="counter-tag">${link.counter}</span>` : "";

  return `<div class="impl-card${cardClass}">
    <div class="impl-label">
      <span class="${arrowClass}">${link.label}</span>${counterHtml}
      <span class="proof-toggle" style="float:right;">‚ñ∏ id√©e de preuve</span>
    </div>
    <div class="impl-proof">${link.proof}</div>
  </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FILTERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.querySelectorAll(".filter-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const filter = btn.dataset.filter;

    if (filter === "all") {
      nodeGroups.style("display", "block");
      linkElements.style("display", "block");
      simulation.alpha(0.3).restart();
      return;
    }

    nodeGroups.style("display", d => d.group === filter ? "block" : "none");
    linkElements.style("display", l => {
      const s = typeof l.source === "object" ? l.source : nodes.find(n => n.id === l.source);
      const t = typeof l.target === "object" ? l.target : nodes.find(n => n.id === l.target);
      return (s.group === filter || t.group === filter) ? "block" : "none";
    });
    simulation.alpha(0.3).restart();
  });
});

// Initial zoom fit
setTimeout(() => {
  svg.call(zoom.transform, d3.zoomIdentity.translate(width*0.05, height*0.05).scale(0.9));
}, 500);
</script>
<tm-footer></tm-footer>

<script src="components.js"></script>
<script src="/cookie-consent.js"></script>
</body>
</html>
